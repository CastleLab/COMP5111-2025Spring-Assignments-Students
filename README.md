# HKUST COMP5111 (2025Spring) Assignment 1 - TA Implementation

## Contents

We provide you with a TA implementation of Assignment 1 for your reference. You can run this TA implementation to get a detailed coverage report for your own test suites and compare and address the inconsistency between the reports generated by TA implementation and yours. You may want to reference it to improve your Assignment 2 implementation.

This TA implementation includes:

- Scripts to use Randoop to generate tests.
- Statement/Branch coverage measurement with Soot.

## Prerequisites

- Java: `11`
- Maven: `^3.8.3`
- Unix-based OS: `MacOS` or `Linux`

Note: The source code should work on Windows, but the scripts are not. You may need to write your own scripts on Windows.

## Usage

Clone this repo and Checkout to `asn1-TA_impl` branch:
```bash
git clone <the_url_of_this_project> && cd <project_dir>
git checkout asn1-TA_impl
```

Generate tests using Randoop:
```bash
./scripts/gen-tests-randoop.sh
```

Run tests and measure coverage (modify line 8 to change the test suite):
```bash
./scripts/asn1-run.sh
```
Note that `asn1-run.sh` script execute the main class `comp5111.assignment.Assignment1`, which takes the following 
positional arguments: 
- CoverageType: `0` for Statement; `1` for Branch.
- Junit test suite class: e.g., `comp5111.assignment.cut.Regression_3_Test`
- Classes in CUT to instrument and measure coverage ...

Coverage results will be stored under `./src/test/report`.

## Key Classes

comp5111.assignment.instrument.InstrumentTransfermer: InstrumentTransformer extends Soot's Transformer, which is extended by [coverageType]Instrumenter to define how this specific type of coverage should instrument the CUT.

comp5111.assignment.instrument.coverage.[Branch|Statement]Instrumenter: these two classes identify the location to be instrumented and how instrumentation should be carried on for the type of coverage.

comp5111.assignment.instrument.coverage.[Branch|Statement]TestRequirement: these two classes define the two types of test requirements for branch/statement coverage.

comp5111.assignment.instrument.runtime.* are classes that will be called by the instrumented CUT during runtime.

comp5111.assignment.instrument.runtime.Profiler: During the execution of JUnit tests, this class will be called to count the visit times of each test requirement (the invocation statements are instrumented in InstrumentTransformer).

## Clarification

The coverage result generated by this implementation may have some difference from the report generated by Eclemma in Eclipse. 

It is expected since they use different intermediate representations and coverage measurement strategies [(Eclemma Issue)](https://github.com/jacoco/eclemma/issues/65).
